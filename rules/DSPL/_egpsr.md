**現在ルール策定中ですので，今後変更となる可能性があります．**

**EGPSRは，コマンドカテゴリ関連やコマンドジェネレータ関連で大きくルールのアップデートが見込まれます．ここに載っているルールはあくまで去年のルールとしてお考え下さい．**

# Enhanced General Purpose Service Robot (EGPSR) for DSPL
- 参考動画：https://youtu.be/Hmcg-QO8Nso 
- ※ 参考動画は完璧ではない．年によってルールが異なるため，参考程度にすること．
- ※ 詳細なルールや配点については検討中である．


## メインゴール
アリーナ内で諸問題を解決すること．

## フォーカス
ロボットはアリーナを清掃し，人々を支援することで家庭環境を維持する．このタスクでは，タスクプランニング，物体/人の検出・認識，物体操作に焦点を当てる．

## セットアップ
- ロケーション: アリーナ内は事前にマッピングすることができる(既知の環境)．
- スタートロケーション: ロボットは，アリーナの外からスタートする．

- ゴミ: 床にある物体(ゴミ)をロボットが認識し，それをゴミ箱に捨てる必要がある．
- 物体: 元の位置から移動されている物体を元の位置へ戻す．
- オペレータ: アリーナ内の人物は，ロボットにリクエストを送ることができる．人物が手を挙げると，ロボットはその人物へ近づき，リクエストに対応する．ランダムに選択されたタスクを，ロボットに実行するように命令する．オペレータは観客やレフェリーから選ばれる．
 


## シナリオ
- 競技時間：競技時間は10分間である．
- 命令の使用言語は英語である．

### a. スタートフェーズ


### b. コマンドフェーズ

### c. サービスフェーズ

## 注意
- ※ 「命令を理解できた」のみの点数を取ることを禁止とする．
  - 「命令を理解できた」の得点を得るためには，「コマンドカテゴリxを成功」に対し何点かの得点があったことが条件である．
  - 得点を1点も取らずに，コマンドをスキップして次のコマンドを求めることは認める（コマンドのスキップ，最大3回まで）
- ※ コマンドの配点が上がる条件について
  - コマンドの配点が上がる条件として，全段のコマンドを「成功」していることを条件とする．「成功」とは，満点を得られている状態である．
- ※ コマンドジェネレータの事前公開
  - RoboCup@HomeのGitHubに公開されているコマンドジェネレータを使用する． ただしカテゴリやオブジェクト，場所名等は変更される．


## デウスエクスマキナ
本タスクでは，次のデウスエクスマキナが採用される．デウスエクスマキナでは該当アクションの点数は入らないが，より簡単な手法でアクションをスキップし，タスクを継続することができる．

| Action | Bypassing |
| --- | --- |
| コマンドの理解 |✓カスタムオペレータの使用<br>　✓「命令を理解できた」の点数が5点になる<br>✓ARマーカ/QRコードの使用<br>　✓点数は入らないが，タスクの継続が可能 |
| コマンドセットの使用 | チームはコマンドジェネレータの代わりにコマンドセットの命令を要求することができる． |
| タスクの支援 | ロボットがタスクを実施出来ない場合，発話など人間にとって自然な形で支援を要求することができる．このとき，レフェリーはロボットの要求が理解できる場合にロボットを支援する．この際，各回の「コマンドを達成」の点数を上限としてレフェリーが減点する場合がある． |

## コマンドセット
コマンドセットの使用を選択した場合，命令の選択のためにコマンドジェネレータは使用されず，代わりに本テーブルのコマンドセットから1つが選択され，使用される．

| タスクの種類 | 命令文 |
| --- | --- |
| bring |✓Go to the ＄{部屋名}, grasp the ＄{物体名} on the ＄{場所名} and place it on the ＄{場所名}.<br>✓Go to the ＄{部屋名}, grasp the ＄{物体名} on the ＄{場所名} and give it to ＄{人物名}. |
| vision<br>(find obj \| people) | ✓Tell me how many ＄{物体カテゴリー名} there are on the ＄{場所名}.<br>✓Tell me how many people in the ＄{部屋名} are ＄{ポーズ}. |
| navigation<br>(follow, guide) | ✓Go to the ＄{部屋名}, find ＄{人物名} at the ＄{場所名} and follow (him \| her).<br>✓Go to the ＄{部屋名}, find ＄{人物名} at the ＄{場所名} and guide (him \| her) to the ＄{場所名}. |
| navigation<br>(follow, guide) | ✓Go to the ＄{部屋名}, find ＄{人物名} at the ＄{場所名} and answer (his \| her) question. <br> ✓Go to the ＄{部屋名}, find ＄{人物名} at the ＄{場所名} and ask (him \| her) ＄{質問}. |

## 準備
- 準備日
  - 部屋，ロケーション，人物の名称を公開．
  - 物体の置かれる可能性がある場所を公開．
- アナウンス(競技2時間前)
  - アリーナの入口と出口のドアの場所，インストラクションポイントを公開．


## スコアシート
| Action | Score |
| --- | --- |
| 命令を理解できた | 10点×3回 |
| 命令を理解できた（カスタムオペレータ） | 5点×3回 |
| 1回目のコマンド | 　 |
| コマンドカテゴリ0を成功 | 5点 |
| コマンドカテゴリ1を成功 | 10点 |
| コマンドカテゴリ2を成功 | 20点 |
| コマンドカテゴリ3を成功 | 30点 |
| コマンドカテゴリ4を成功 | 40点 |
| 2回目のコマンド | 　 |
| コマンドカテゴリ0を成功 | 10点 |
| コマンドカテゴリ1を成功 | 20点 |
| コマンドカテゴリ2を成功 | 40点 |
| コマンドカテゴリ3を成功 | 60点 |
| コマンドカテゴリ4を成功 | 80点 |
| 3回目のコマンド | 　 |
| コマンドカテゴリ0を成功 | 20点 |
| コマンドカテゴリ1を成功 | 40点 |
| コマンドカテゴリ2を成功 | 80点 |
| コマンドカテゴリ3を成功 | 120点 |
| コマンドカテゴリ4を成功 | 160点 |

- ※各コマンドは，次のパーセンテージで部分点を付ける
  - 1ヵ所以上適切な場所へ自律移動する 25%
  - 1人以上の適切な人物／1つ以上の適切な物体へ何かしらアプローチする 25%
